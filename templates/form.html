<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visitor Request Form</title>
    <link rel="stylesheet" href="../static/assets/css/form.css">
    <style>
        body, html {
            background-image: url('../static/assets/bg-img.png');
        }
    </style>
    <script>
        async function fetchManagersAndGates() {
            try {
                const response = await fetch('https://your-app-name.herokuapp.com/api/managers_and_gates');
                const data = await response.json();
                populateForm(data);
            } catch (error) {
                console.error('Error fetching managers and gates:', error);
            }
        }

        function populateForm(data) {
            const managerSelect = document.getElementById('manager');
            const gateSelect = document.getElementById('gateNumber');

            data.managers.forEach(manager => {
                const option = document.createElement('option');
                option.value = manager.id;
                option.textContent = manager.name;
                managerSelect.appendChild(option);
            });

            data.gates.forEach(gate => {
                const option = document.createElement('option');
                option.value = gate.id;
                option.textContent = gate.gate_number;
                gateSelect.appendChild(option);
            });
        }

        document.addEventListener('DOMContentLoaded', fetchManagersAndGates);
    </script>
</head>
<body>
    <div class="navbar">
        <div class="logo">
            <img src="../static/assets/Camreon-icon.jpeg" alt="Logo">
        </div>
        <div class="nav-options">
            <a href="../index.html">Home</a>
            <a href="#">Link</a>
            <a href="#">Dropdown</a>
            <a href="#" class="disabled">Disabled</a>
        </div>
    </div>

    <div class="container">
        <div class="left">
            <h1>Visitor Request Form</h1>
            <p>This Form will help the company to manage the system better</p>
            <p>Schedule an appointment to visit the company by filling the fields and choosing a manager</p>
        </div>
        <div class="right">
            <form id="visitForm" action="/submit" method="POST" enctype="multipart/form-data">
                <label for="numVisitors">Choose the number of Visitors:</label><br>
                <input type="number" id="numVisitors" name="numVisitors" min="1" max="15" value="1" onchange="addVisitorFields()" class="contact-inputs"><br><br>

                <div id="VisitorsContainer"></div>
                
                <label for="dateTime">DATE/TIME*</label><br>
                <input type="datetime-local" id="dateTime" name="dateTime" required><br><br>
                <label for="manager">CHOOSE A MANAGER*</label><br>
                <select id="manager" name="manager" required></select><br><br>
                <label for="gateNumber">Gate Number:</label>
                <select id="gateNumber" name="gateNumber" required></select><br><br>

                <input type="hidden" name="status" value="Pending">

                <button type="submit">Submit</button>
            </form>
        </div>
    </div>
</body>
</html>
